<!-- Report Concern Page -->
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card" style="border-left: 4px solid #FF6B6B;">
                <div class="card-body">
                    <h1 class="mb-2">
                        <i class="bi bi-exclamation-circle"></i> Report a Concern
                    </h1>
                    <p class="text-muted mb-0" th:if="${session.userRole != 'STAFF'}">
                        Share your mental health concern confidentially so we can provide appropriate support and resources
                    </p>
                    <p class="text-muted mb-0" th:if="${session.userRole == 'STAFF'}">
                        Report a mental health concern for a student you are monitoring. This will be reviewed by a mental health professional.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Emergency Alert -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="alert alert-danger border-2" role="alert">
                <div class="d-flex align-items-start">
                    <i class="bi bi-exclamation-triangle-fill me-3" style="font-size: 1.5rem;"></i>
                    <div>
                        <h5 class="alert-heading mb-2">üö® In an Emergency:</h5>
                        <p class="mb-0">
                            If you or someone else is in immediate danger, please call <strong>911</strong> or the National Crisis Hotline at <strong>988</strong> immediately. This form is not monitored 24/7.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <form th:action="@{/concerns/report}" method="post" id="concernForm">
                <!-- Level of Urgency -->
                <div class="card mb-4" style="border-left: 4px solid #FF9F1C;">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-exclamation-circle"></i> Level of Urgency
                        </h5>
                        <small class="text-muted">How urgent is this concern? This helps us prioritize responses.</small>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Select urgency level</label>
                            <select class="form-select" name="urgencyLevel" required>
                                <option value="">Select...</option>
                                <option value="LOW">üü¢ Low - I'd like to discuss this at my convenience (Response within 48 hours)</option>
                                <option value="MODERATE">üü° Moderate - I need support soon (Response within 24 hours)</option>
                                <option value="HIGH">üî¥ High - I need urgent support (Response within 2 hours)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Type of Concern -->
                <div class="card mb-4" style="border-left: 4px solid #9B7EDE;">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-heart"></i> Type of Concern
                        </h5>
                        <small class="text-muted">Select all that apply to help us understand your situation better</small>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="ANXIETY" id="anxiety">
                                    <label class="form-check-label" for="anxiety">
                                        üò∞ Anxiety or Panic
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="DEPRESSION" id="depression">
                                    <label class="form-check-label" for="depression">
                                        üòî Depression or Low Mood
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="STRESS" id="stress">
                                    <label class="form-check-label" for="stress">
                                        üò£ Stress or Overwhelm
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="SUICIDAL" id="suicidal">
                                    <label class="form-check-label" for="suicidal">
                                        üÜò Suicidal Thoughts
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="SELF_HARM" id="selfHarm">
                                    <label class="form-check-label" for="selfHarm">
                                        ‚ö†Ô∏è Self-Harm
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="RELATIONSHIP" id="relationship">
                                    <label class="form-check-label" for="relationship">
                                        üíî Relationship Issues
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="ACADEMIC" id="academic">
                                    <label class="form-check-label" for="academic">
                                        üìö Academic Pressure
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="SUBSTANCE" id="substance">
                                    <label class="form-check-label" for="substance">
                                        üö´ Substance Use
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="EATING" id="eating">
                                    <label class="form-check-label" for="eating">
                                        üçΩÔ∏è Eating or Body Image
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="TRAUMA" id="trauma">
                                    <label class="form-check-label" for="trauma">
                                        üí≠ Trauma or PTSD
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check p-3 border rounded">
                                    <input class="form-check-input" type="checkbox" name="concernTypes" value="OTHER" id="other">
                                    <label class="form-check-label" for="other">
                                        üí¨ Other
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Student Information Card (Staff Only) -->
                <div class="card mb-4" th:if="${session.userRole == 'STAFF'}" style="border-left: 4px solid #6A8EAE;">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-person-circle"></i> Student Information
                        </h5>
                        <small class="text-muted">Please provide information about the student you are monitoring</small>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Student Name or ID <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" 
                                       placeholder="e.g., John Doe or Student #12345"
                                       name="studentName" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Student Email</label>
                                <input type="email" class="form-control" 
                                       placeholder="student@university.edu"
                                       name="studentEmail">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Contact Number (Optional)</label>
                                <input type="tel" class="form-control" 
                                       placeholder="+1 (555) 123-4567"
                                       name="studentPhone">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Program/Year</label>
                                <input type="text" class="form-control" 
                                       placeholder="e.g., Computer Science, 2nd Year"
                                       name="studentProgram">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Additional Student Information</label>
                            <textarea class="form-control" rows="3"
                                      placeholder="Any additional context about the student (e.g., course, year, previous concerns)"
                                      name="studentAdditionalInfo"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Describe Concern -->
                <div class="card mb-4" style="border-left: 4px solid #6A8EAE;">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-info-circle"></i> 
                            <span th:if="${session.userRole == 'STAFF'}">Describe the Concern</span>
                            <span th:if="${session.userRole != 'STAFF'}">Describe Your Concern</span>
                        </h5>
                        <small class="text-muted" th:if="${session.userRole == 'STAFF'}">
                            Provide detailed observations and behaviors that concern you about this student
                        </small>
                        <small class="text-muted" th:if="${session.userRole != 'STAFF'}">
                            Share as much detail as you feel comfortable with. This information helps us provide better support.
                        </small>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <textarea class="form-control" rows="6"
                                      th:placeholder="${session.userRole == 'STAFF'} ? 
                                          'Describe the student\'s behavior, any concerning patterns you\'ve noticed, specific incidents, changes in academic performance, or other observations...' : 
                                          'Tell us what\'s been happening and how you\'ve been feeling. Include any specific situations, symptoms, or challenges you\'re experiencing...'"
                                      name="description" required></textarea>
                        </div>

                        <!-- Contact Permission (Students) -->
                        <div class="form-check p-3 bg-light rounded mb-3" th:if="${session.userRole != 'STAFF'}">
                            <input class="form-check-input" type="checkbox" name="contactPermission" id="contactPermission">
                            <label class="form-check-label" for="contactPermission">
                                <strong>‚úÖ Contact Permission</strong><br>
                                <small>I give permission to be contacted by a mental health professional to discuss this concern and receive support</small>
                            </label>
                        </div>

                        <!-- Notification Permission (Staff) -->
                        <div class="form-check p-3 bg-light rounded mb-3" th:if="${session.userRole == 'STAFF'}">
                            <input class="form-check-input" type="checkbox" name="notificationPermission" id="notificationPermission">
                            <label class="form-check-label" for="notificationPermission">
                                <strong>‚úÖ Notification Permission</strong><br>
                                <small>I authorize a mental health professional to contact the student and provide updates to me regarding their wellbeing</small>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Privacy Notice -->
                <div class="card mb-4 bg-light" style="border-left: 4px solid #6A8EAE;">
                    <div class="card-body">
                        <div class="d-flex align-items-start">
                            <i class="bi bi-shield-check me-3" style="font-size: 1.5rem; color: #6A8EAE;"></i>
                            <div>
                                <h6 class="mb-2">
                                    <span class="me-2">üîí</span> Your Privacy is Protected
                                </h6>
                                <p class="small text-muted mb-0">
                                    All information shared is confidential and will only be accessed by qualified mental health 
                                    professionals. Your report will be handled with care and in accordance with privacy regulations 
                                    and university privacy policies.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Buttons -->
                <div class="d-flex gap-3 mb-4">
                    <a th:href="@{/dashboard}" class="btn btn-secondary flex-fill">Cancel</a>
                    <button type="submit" class="btn btn-primary flex-fill">
                        <i class="bi bi-send"></i> Submit Concern
                    </button>
                </div>
            </form>
        </div>

        <!-- Guidelines Sidebar (Staff Only) -->
        <div class="col-md-4" th:if="${session.userRole == 'STAFF'}">
            <div class="card sticky-top" style="top: 90px; border-left: 4px solid #7FB685;">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-info-circle"></i> Guidelines
                    </h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-3">
                            <strong><i class="bi bi-check-circle text-success"></i> Be Specific</strong>
                            <p class="small text-muted mb-0">Provide clear details about what you observed or were told.</p>
                        </li>
                        <li class="mb-3">
                            <strong><i class="bi bi-check-circle text-success"></i> Include Context</strong>
                            <p class="small text-muted mb-0">Mention when and where the concern was observed.</p>
                        </li>
                        <li class="mb-3">
                            <strong><i class="bi bi-check-circle text-success"></i> Respect Privacy</strong>
                            <p class="small text-muted mb-0">Only share information relevant to the concern.</p>
                        </li>
                        <li class="mb-3">
                            <strong><i class="bi bi-exclamation-triangle text-warning"></i> Urgent Matters</strong>
                            <p class="small text-muted mb-0">For immediate safety concerns, contact emergency services first.</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Crisis Resources -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card bg-light" style="border-left: 4px solid #9B7EDE;">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-telephone"></i> üìû Crisis Resources - Available 24/7
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="p-3 bg-white rounded border">
                                <p class="fw-semibold mb-1">üÜò National Crisis Hotline</p>
                                <p class="small text-muted mb-0">Call or text <strong class="text-primary">988</strong> - Available 24/7</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="p-3 bg-white rounded border">
                                <p class="fw-semibold mb-1">üí¨ Crisis Text Line</p>
                                <p class="small text-muted mb-0">Text <strong class="text-primary">HOME</strong> to <strong class="text-primary">741741</strong> - Available 24/7</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="p-3 bg-white rounded border">
                                <p class="fw-semibold mb-1">üö® Campus Security</p>
                                <p class="small text-muted mb-0">Call <strong class="text-primary">(123) 456-7890</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
